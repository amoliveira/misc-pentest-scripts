#!/bin/bash

if [[ $1 == "" ]]; then
	echo "Wrong usage. Example:"
	echo -e "\t$0 [HOST]"
	exit 1
fi

host_ip=$(host $1 | grep "has address" | cut -d " " -f4)
ip_range=$(whois $host_ip | grep "inetnum" | cut -d ":" -f2 | xargs)
lo_host=$(echo $ip_range | cut -d " " -f1)
hi_host=$(echo $ip_range | cut -d " " -f3)
ip_base=$(echo $lo_host | sed 's/...$//')

echo -e "\n\e[93m=================/////////////////////////=========================="
echo -e "\e[93m=================/// \e[39m\e[1mREVERSE DNS SEARCH\e[0m\e[93m ///========================="
echo -e "\e[93m=================/////////////////////////==========================\e[39m\n"

echo -e "\e[1m\t    IP Range: $ip_range\n"

for host in $(seq $(echo $lo_host | cut -d "." -f4) $(echo $hi_host | cut -d "." -f4)); do
	#host -t ptr $ip_base$host | sed 's/-/\./g' # | grep -v $(echo $ip_base$host | awk -F . '{print ip$4".ip."$3"."$2"."$1""}')
	resp=$(host -t ptr $ip_base$host | sed 's/-/\./g' | grep -v $(echo $ip_base$host | awk -F . '{print $1"."$2"."$3".eu"}'))
	
	if [[ $resp != "" ]]; then
		echo -en "\e[1m\e[93m\t$ip_base$host"
		echo -en "\e[0m =========>"
		echo -e "\e[92m $(echo $resp | cut -d " " -f5)"
	fi
done

echo -e "\n\e[93m====================================================================\e[39m\n"
