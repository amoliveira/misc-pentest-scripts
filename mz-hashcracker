#!/usr/bin/env python3

import crypt
import argparse

parser = argparse.ArgumentParser(description = '(hash cracker by Leonardo Militz')
parser.add_argument('-hash', action = 'store', dest = 'hash', 
					required = True, help = 'Hash to decode (shadow file format)')
parser.add_argument('-w', action = 'store', dest = 'wordlist', 
					required = False, help = 'Wordlist used to decode.', default = "/usr/share/john/password.lst")

arguments = parser.parse_args()
wordlist_name = str(arguments.wordlist)
crackWord = arguments.hash

found = False
result = ''
kind = '(default)'

salt = crackWord.split("$")
salt = f"${salt[1]}${salt[2]}$"

if (wordlist_name != "/usr/share/john/password.lst"): kind = '(custom)' 

print("===============================================================")
print(f"Hash: {crackWord}\nWordlist: {wordlist_name} {kind}")
print("===============================================================")

with open(wordlist_name) as wordlist:
	for line in wordlist:
		word = line.strip().encode('utf-8')
		res  = crypt.crypt(word.decode('utf-8'), salt)

		if res == crackWord:
			found = True
			result = f"\nFOUND ===> {crackWord} ===> {word.decode('utf-8')}\n"
			break

if found: 
	print(result)
else:
	print("\nCouldn't crack this hash with the provided wordlist.\n")

print("===============================================================")

